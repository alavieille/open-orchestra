<section class="" id="widget-grid">

    <!-- row -->
    <div class="row">

        <!-- NEW WIDGET START -->
        <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12 sortable-grid ui-sortable">

            <!-- Widget ID (each widget will need unique ID)-->
            <div class="jarviswidget jarviswidget-color-darken" id="wid-id-0" data-widget-editbutton="false">
                <!-- widget options:
                usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

                data-widget-colorbutton="false"
                data-widget-editbutton="false"
                data-widget-togglebutton="false"
                data-widget-deletebutton="false"
                data-widget-fullscreenbutton="false"
                data-widget-custombutton="false"
                data-widget-collapsed="true"
                data-widget-sortable="false"

                -->
                <header>
                    <span class="widget-icon"> <i class="fa fa-table"></i> </span>
                    <h2>Standard Data Tables </h2>

                </header>

                <!-- widget div-->
                <div>

                    <!-- widget edit box -->
                    <div class="jarviswidget-editbox">
                        <!-- This area used as dropdown edit box -->

                    </div>
                    <!-- end widget edit box -->

                    <!-- widget content -->
                    <div class="widget-body no-padding">
                        <div class="widget-body-toolbar">

                        </div>
                        <table id="datatable_fixed_column" class="table table-striped table-bordered smart-form">
                            <thead>
                                <tr class="second">
                                {% for key, search in searchs %}
                                    <td>
                                        <label class="input">
                                    {% if search['type'] == 'text' %}
                                            <input type="text" name="{{ search['name'] }}" placeholder="Filter {{ labels[key] }}" class="search_init">
                                    {% endif %}
                                        </label>
                                    </td>
                                {% endfor %}
                                </tr>
                                <tr>
                                {% for label in labels %}
                                    <th>{{ label }}</th>
                                {% endfor %}
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <!-- end widget content -->

                </div>
                <!-- end widget div -->

            </div>
            <!-- end widget -->
        </article>
        <!-- WIDGET END -->

    </div>

    <!-- end row -->

</section>

<script type="text/javascript">

    // DO NOT REMOVE : GLOBAL FUNCTIONS!
    pageSetUp();
    
    // PAGE RELATED SCRIPTS

    /* remove previous elems */
    
    if($('.DTTT_dropdown.dropdown-menu').length){
        $('.DTTT_dropdown.dropdown-menu').remove();
    }

    loadDataTableScripts();
    function loadDataTableScripts() {
        
        loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/media/css/jquery.dataTables.min.css') }}");
        loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/media/css/jquery.dataTables_themeroller.min.css') }}");
        loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/media/js/jquery.dataTables.min.js') }}", dt_1);
        
        function dt_1() {
            loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/AutoFill/css/dataTables.autoFill.min.css') }}");
            loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/AutoFill/js/dataTables.autoFill.min.js') }}", dt_2);
        }
        function dt_2() {
            loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/ColReorder/css/dataTables.colReorder.min.css') }}");
            loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/ColReorder/js/dataTables.colReorder.min.js') }}", dt_3);
        }
        function dt_3() {
            loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/ColVis/css/dataTables.colVis.min.css') }}");
            loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/ColVis/js/dataTables.colVis.min.js') }}", dt_4);
        }
        function dt_4() {
            loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/FixedColumns/css/dataTables.fixedColumns.min.css') }}");
            loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/FixedColumns/js/dataTables.fixedColumns.min.js') }}", dt_5);
        }
        function dt_5() {
            loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/FixedHeader/css/dataTables.fixedHeader.min.css') }}");
            loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/FixedHeader/js/dataTables.fixedHeader.min.js') }}", dt_6);
        }
        function dt_6() {
            loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/KeyTable/css/dataTables.keyTable.min.css') }}");
            loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/KeyTable/js/dataTables.keyTable.min.js') }}", dt_7);
        }
        function dt_7() {
            loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/Scroller/css/dataTables.scroller.min.css') }}");
            loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/Scroller/js/dataTables.scroller.min.js') }}", dt_8);
        }
        function dt_8() {
            loadCss("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/TableTools/css/dataTables.tableTools.min.css') }}");
            loadScript("{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/TableTools/js/dataTables.tableTools.min.js') }}", runDataTables);
        }
    }
    function runDataTables() {
        /* Add the events etc before DataTables hides a column 
        $("#datatable_fixed_column thead input").keyup(function() {
            oTable.fnFilter(this.value, oTable.oApi._fnVisibleToColumnIndex(oTable.fnSettings(), $("thead input").index(this)));
        });*/

        $('#datatable_fixed_column').dataTable({
            "serverSide": true,
            "ordering": true,
            "searching": false,
            "scroller": {
                "loadingIndicator": true,
                "displayBuffer": 2
            },
            "ajax": function ( data, callback, settings ) {
                var start = (data.start) ? data.start : 0;
                var end = (data.end) ? data.end : 10;
                var criteria = $('.search_init').filter(function() { return $(this).val() != ""; }).serialize();
                var sort = {};
                var rank = 0;
                if(rank = $('.dataTables_scrollHead .sorting_asc').index() >= 0){
                    var name = $('.search_init').eq(rank).attr('name');
                    sort[name] = -1;            
                }
                else if(rank = $('.dataTables_scrollHead .sorting_desc').index() >= 0){
                    var name = $('.search_init').eq(rank).attr('name');
                    sort[name] = 1;            
                }
                $.ajax({
                    "type": "POST",
                    "url": "{{ path('php_orchestra_cms_bo_site') }}",
                    "dataType": "json",
                    "data": { "parse": true, "start": start, "end": end, "criteria": criteria, "sort": sort},
                })
                .done(function( records ) {
                    out = records.data;
                    callback( {
                        draw: data.draw,
                        data: out,
                        recordsTotal: 2,
                        recordsFiltered: 1
                    } );
                });
            },
            "dom": 'R<"top-tools"TC><"clear">rtiS',
            "tableTools": {
                "sSwfPath": "{{ asset('bundles/phporchestracms/js/plugin/DataTables-1.10.0/extensions/TableTools/swf/copy_csv_xls_pdf.swf') }}"
            },
            "scrollY": 200
        } );
    }

</script>